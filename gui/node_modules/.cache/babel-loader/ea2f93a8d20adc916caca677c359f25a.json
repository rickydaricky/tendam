{"ast":null,"code":"var _jsxFileName = \"/Users/riarajesh/cs0320/maps-3-4-mhendrik-rrajesh/maps-frontend/src/CheckinFeed.js\",\n    _s = $RefreshSig$();\n\nimport './App.css';\nimport React, { useState, useEffect, useRef } from 'react';\nimport axios from 'axios';\nimport \"react-awesome-button/dist/styles.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nfunction CheckinFeed() {\n  _s();\n\n  const REQUEST_WAIT = 3000; // Is every 3 seconds a good interval?\n\n  const [checkins, setCheckins] = useState([]);\n  const timeoutLoop = useRef(0);\n  const [userData, setUserData] = useState([]);\n\n  function requestNewCheckinsLoop() {\n    timeoutLoop.current = window.setTimeout(() => {\n      requestNewCheckins();\n      requestNewCheckinsLoop();\n    }, REQUEST_WAIT);\n  }\n\n  useEffect(() => {\n    requestNewCheckinsLoop();\n    return () => window.clearTimeout(timeoutLoop.current);\n  });\n  /**\n   * Makes an axios request to get all the newest checkin data.\n   */\n\n  function requestNewCheckins() {\n    const config = {\n      headers: {\n        \"Content-Type\": \"application/json\",\n        'Access-Control-Allow-Origin': '*'\n      }\n    };\n    axios.get(\"http://localhost:4567/newCheckins\", config).then(response => {\n      return response.data;\n    }).then(data => {\n      if (checkins.length === 0) {\n        setCheckins(data);\n      } else {\n        setCheckins(checkins.concat(data));\n      }\n    }).catch(function (error) {\n      console.log(error);\n    });\n  } //stackoverflow post cited in https://piazza.com/class/kjj61bh31hz24x?cid=1865\n  //used https://stackoverflow.com/questions/847185/convert-a-unix-timestamp-to-time-in-javascript\n\n\n  function timestampToDate(timestamp) {\n    let date = new Date(timestamp * 1000);\n    let hours = date.getHours();\n    let minutes = \"0\" + date.getMinutes();\n    let seconds = \"0\" + date.getSeconds();\n    let formattedTime = hours + \":\" + minutes.substr(-2) + \":\" + seconds.substr(-2);\n    return formattedTime;\n  }\n\n  function getDataForUser(userID) {\n    const toSend = {\n      userID: userID\n    };\n    const config = {\n      headers: {\n        \"Content-Type\": \"application/json\",\n        'Access-Control-Allow-Origin': '*'\n      }\n    };\n    axios.post(\"http://localhost:4567/specificCheckins\", toSend, config).then(response => {\n      return response.data;\n    }).then(data => {\n      setUserData(data);\n    }).catch(function (error) {\n      console.log(error);\n    });\n  }\n\n  const deleteUser = userID => {\n    console.log(\"deleting user \" + userID);\n    const toSend = {\n      userID: userID\n    };\n    const config = {\n      headers: {\n        \"Content-Type\": \"application/json\",\n        'Access-Control-Allow-Origin': '*'\n      }\n    };\n    axios.post(\"http://localhost:4567/deleteUser\", toSend, config).then(response => {\n      console.log(response);\n      setUserData([]);\n    }).catch(function (error) {\n      console.log(error);\n    });\n  };\n\n  const renderDeleteUserButton = () => {\n    if (userData.length > 0) {\n      return /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => {\n          deleteUser(userData[0][1]);\n        },\n        children: [\"Delete all data on \", userData[0][2]]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 20\n      }, this);\n    } else {\n      return null;\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"checkinFeed\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Live Checkin Feed\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 125,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"scrollable\",\n      children: checkins.map((checkin, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"canHover clickable\",\n        onClick: () => {\n          getDataForUser(checkin[1]);\n        },\n        children: [checkin[2], \" checked in to \", checkin[3], \", \", checkin[4], /*#__PURE__*/_jsxDEV(\"span\", {\n          children: \" \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 25\n        }, this), \"at \", timestampToDate(checkin[0])]\n      }, index, true, {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 21\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 126,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"Specific User Data\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"scrollable\",\n      children: [renderDeleteUserButton(), userData.map((checkin, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"canHover\",\n        children: [checkin[2], \" checked in to \", checkin[3], \", \", checkin[4], /*#__PURE__*/_jsxDEV(\"span\", {\n          children: \" \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 140,\n          columnNumber: 25\n        }, this), \"at \", timestampToDate(checkin[0])]\n      }, index, true, {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 21\n      }, this))]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 124,\n    columnNumber: 9\n  }, this);\n}\n\n_s(CheckinFeed, \"NhNoJlZ5hjWcaI8o9H9TG1YRu5I=\");\n\n_c = CheckinFeed;\nexport default CheckinFeed;\n\nvar _c;\n\n$RefreshReg$(_c, \"CheckinFeed\");","map":{"version":3,"sources":["/Users/riarajesh/cs0320/maps-3-4-mhendrik-rrajesh/maps-frontend/src/CheckinFeed.js"],"names":["React","useState","useEffect","useRef","axios","CheckinFeed","REQUEST_WAIT","checkins","setCheckins","timeoutLoop","userData","setUserData","requestNewCheckinsLoop","current","window","setTimeout","requestNewCheckins","clearTimeout","config","headers","get","then","response","data","length","concat","catch","error","console","log","timestampToDate","timestamp","date","Date","hours","getHours","minutes","getMinutes","seconds","getSeconds","formattedTime","substr","getDataForUser","userID","toSend","post","deleteUser","renderDeleteUserButton","map","checkin","index"],"mappings":"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","sourcesContent":["import './App.css';\nimport React, {useState, useEffect, useRef} from 'react';\nimport axios from 'axios';\nimport \"react-awesome-button/dist/styles.css\";\n\nfunction CheckinFeed() {\n    const REQUEST_WAIT = 3000; // Is every 3 seconds a good interval?\n    const [checkins, setCheckins] = useState([]);\n    const timeoutLoop = useRef(0);\n    const [userData, setUserData] = useState([]);\n\n    function requestNewCheckinsLoop() {\n        timeoutLoop.current = window.setTimeout(() => {\n            requestNewCheckins();\n            requestNewCheckinsLoop();\n        }, REQUEST_WAIT);\n    }\n\n    useEffect(() => {\n        requestNewCheckinsLoop();\n        return () => window.clearTimeout(timeoutLoop.current);\n    });\n\n    /**\n     * Makes an axios request to get all the newest checkin data.\n     */\n    function requestNewCheckins() {\n        const config = {\n            headers: {\n                \"Content-Type\": \"application/json\",\n                'Access-Control-Allow-Origin': '*',\n            }\n        }\n        axios.get(\n            \"http://localhost:4567/newCheckins\",\n            config\n        )\n            .then(response => {\n                return response.data;\n            })\n            .then((data) => {\n                if (checkins.length === 0) {\n                    setCheckins(data);\n                } else {\n                    setCheckins(checkins.concat(data));\n                }\n            })\n            .catch(function (error) {\n                console.log(error);\n            });\n    }\n\n    //stackoverflow post cited in https://piazza.com/class/kjj61bh31hz24x?cid=1865\n    //used https://stackoverflow.com/questions/847185/convert-a-unix-timestamp-to-time-in-javascript\n    function timestampToDate(timestamp) {\n        let date = new Date(timestamp * 1000);\n        let hours = date.getHours();\n        let minutes = \"0\" + date.getMinutes();\n        let seconds = \"0\" + date.getSeconds();\n        let formattedTime = hours + \":\" + minutes.substr(-2) + \":\" + seconds.substr(-2);\n        return formattedTime;\n    }\n\n    function getDataForUser(userID) {\n        const toSend = {\n            userID: userID\n        };\n        const config = {\n            headers: {\n                \"Content-Type\": \"application/json\",\n                'Access-Control-Allow-Origin': '*',\n            }\n        }\n        axios.post(\n            \"http://localhost:4567/specificCheckins\",\n            toSend,\n            config\n        )\n            .then(response => {\n                return response.data;\n            })\n            .then((data) => {\n                setUserData(data);\n            })\n            .catch(function (error) {\n                console.log(error);\n            });\n    }\n\n    const deleteUser = (userID) => {\n        console.log(\"deleting user \" + userID);\n        const toSend = {\n            userID: userID\n        };\n        const config = {\n            headers: {\n                \"Content-Type\": \"application/json\",\n                'Access-Control-Allow-Origin': '*',\n            }\n        }\n        axios.post(\n            \"http://localhost:4567/deleteUser\",\n            toSend,\n            config\n        )\n            .then(response => {\n                console.log(response);\n                setUserData([]);\n            })\n            .catch(function (error) {\n                console.log(error);\n            });\n    }\n\n    const renderDeleteUserButton = () => {\n        if(userData.length > 0) {\n            return <button onClick={() => {deleteUser(userData[0][1])}}>Delete all data on {userData[0][2]}</button>\n        } else {\n            return null;\n        }\n    }\n\n    return (\n        <div className={\"checkinFeed\"}>\n            <h2>Live Checkin Feed</h2>\n            <div className={\"scrollable\"}>\n                {checkins.map((checkin, index) =>\n                    <div className={\"canHover clickable\"} key={index} onClick={() => {getDataForUser(checkin[1])}}>\n                        {checkin[2]} checked in to {checkin[3]}, {checkin[4]}\n                        <span> </span>at {timestampToDate(checkin[0])}\n                    </div>\n                )}\n            </div>\n            <h2>Specific User Data</h2>\n            <div className={\"scrollable\"}>\n                {renderDeleteUserButton()}\n                {userData.map((checkin, index) =>\n                    <div className={\"canHover\"} key={index}>\n                        {checkin[2]} checked in to {checkin[3]}, {checkin[4]}\n                        <span> </span>at {timestampToDate(checkin[0])}\n                    </div>\n                )}\n            </div>\n        </div>\n    );\n}\n\nexport default CheckinFeed;"]},"metadata":{},"sourceType":"module"}